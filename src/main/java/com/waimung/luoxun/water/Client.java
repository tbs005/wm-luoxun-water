package com.waimung.luoxun.water;

import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.net.Socket;

import org.springframework.util.StringUtils;

public class Client {
	public static void main(String args[]) {
//		String cmdInfor="4040a7000101303b12190314882d1d0000000000000000009a03020214010101010000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101020000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101030000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101040000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101050000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101060000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101070000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101080000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101090000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010a0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010b0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010c0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010d0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010e0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010f0000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101100000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101110000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101120000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101130000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101140000000300202020202020202020202020202020202020202020202020202020202020200000080101e2112323";
//		String cmdInfor="4040a6000101293612190314882d1d0000000000000000008200020308010101190000000100002e3b121903140101011a0000000100002e3b121903140101011b0000000100002e3b121903140101011c0000000100002e3b121903140101011d0000000100002e3b121903140101011e0000000100002e3b121903140101011f0000000100002e3b12190314010101200000000100002e3b12190314062323";

//		String cmdInfor ="4040fc0001011f0816190314882d1d0000000000000000009a03020214010101010000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101020000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101030000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101040000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101050000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101060000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101070000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101080000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101090000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010a0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010b0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010c0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010d0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010e0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010f0000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101100000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101110000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101120000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101130000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101140000000300202020202020202020202020202020202020202020202020202020202020200000080101e21e2323";

//		String cmdInfor ="4040650001012f090e1e0314036423082f000000000000009a03020214010101010000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101020000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101030000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101040000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101050000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101060000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101070000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101080000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101090000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010a0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010b0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010c0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010d0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010e0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010f0000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101100000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101110000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101120000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101130000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101140000000300202020202020202020202020202020202020202020202020202020202020200000080101e2862323";
		String cmdInfor = "40406e0001012b1c0f020414036423082f000000000000009a03020214010101010000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101020000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101030000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101040000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101050000000100202020202020202020202020202020202020202020202020202020202020200000080101e2010101060000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101070000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101080000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101090000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010a0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010b0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010c0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010d0000000100202020202020202020202020202020202020202020202020202020202020200000080101e20101010e0000000300202020202020202020202020202020202020202020202020202020202020200000080101e20101010f0000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101100000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101110000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101120000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101130000000300202020202020202020202020202020202020202020202020202020202020200000080101e2010101140000000300202020202020202020202020202020202020202020202020202020202020200000080101e2842323";
		send(cmdInfor);
	}

	public static String send(String testData) {
		String strReturn = null;
		try {
			// 要连接的服务端IP地址
			String host = "localhost";
			// 要连接的服务端对应的监听端口
			int port = 8888;
			// 将十六进制的字符串转换成字节数组
			byte[] testBytes = hexStrToBinaryStr(testData);

			// 1.建立客户端socket连接，指定服务器位置及端口
			Socket clientSocket = new Socket(host, port);

			// 2.得到socket读写流
			OutputStream os = clientSocket.getOutputStream();
			PrintWriter pw = new PrintWriter(os);
			// 输入流
			InputStream is = clientSocket.getInputStream();

			// 3.利用流按照一定的操作，对socket进行读写操作
			os.write(testBytes);
			os.flush();
			clientSocket.shutdownOutput();

			// 接收服务器的响应
			int line = 0;
			byte[] buf = new byte[is.available()];

			// 接收收到的数据
			while ((line = is.read(buf)) != -1) {
				// 将字节数组转换成十六进制的字符串
				strReturn = BinaryToHexString(buf);
			}
			// 4.关闭资源
			is.close();
			pw.close();
			os.close();
			clientSocket.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return strReturn;
	}

	/**
	 * 将十六进制的字符串转换成字节数组
	 *
	 * @param hexString
	 * @return
	 */
	public static byte[] hexStrToBinaryStr(String hexString) {

		if (StringUtils.isEmpty(hexString)) {
			return null;
		}

//		hexString = hexString.replaceAll(" ", "");

		int len = hexString.length();
		int index = 0;

		byte[] bytes = new byte[len / 2];

		while (index < len) {

			String sub = hexString.substring(index, index + 2);

			bytes[index / 2] = (byte) Integer.parseInt(sub, 16);

			index += 2;
		}

		return bytes;
	}

	/**
	 * 将字节数组转换成十六进制的字符串
	 *
	 * @return
	 */
	public static String BinaryToHexString(byte[] bytes) {
		String hexStr = "0123456789ABCDEF";
		String result = "";
		String hex = "";
		for (byte b : bytes) {
			hex = String.valueOf(hexStr.charAt((b & 0xF0) >> 4));
			hex += String.valueOf(hexStr.charAt(b & 0x0F));
			result += hex + " ";
		}
		return result;
	}
}